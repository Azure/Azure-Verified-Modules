{{ $useHeaderRow := .Get "header" }}
{{ $csv := .Get "csv" }}
{{ $file := readFile $csv }}
{{ $rows := $file | transform.Unmarshal (dict "delimiter" ",") }}
{{ $useLinks := .Get "useLinks" | default true }}
<table>
  {{ if $useHeaderRow }}
  {{ $headerRow := index $rows 0 }}
  {{ $rows = after 1 $rows }}
  <thead>
    <tr>
      <th>Module Name</th>
      <th>Module Display Name</th>
      <th>Module Status</th>
      <th>Primary Module Owner GitHub Handle and Display Name</th>
    </tr>
  </thead>
  {{ end }}
  {{ range $row, $rows }}
  <tr>
    <td>{{ if $useLinks }} {{ if or (eq (index $row 4) "Module Available :green_circle:") (eq (index $row 4) "Module Orphaned :eyes:") }} <a href="{{ index $row 5 }}">{{ index $row 3 }}</a> {{ else }} {{ index $row 3 }} {{ end }} {{else}} {{ index $row 3 }} {{ end }} </td>
    <td>{{ index $row 2 }}</td>
    <td>{{ emojify (index $row 4) }}</td>
    <td>{{ index $row 8 }} {{ if and (ne (index $row 8) "") (ne (index $row 9) "") }} ({{ index $row 9 }}){{ end }}</td>
  </tr>
  {{ end }}
</table>
