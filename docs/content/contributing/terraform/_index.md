---
title: Terraform Contribution Guide
geekdocNav: true
geekdocAlign: left
geekdocAnchor: true
---

{{< toc >}}

{{< hint type=tip >}}

Before submitting a new [module proposal](https://aka.ms/avm/moduleproposal) for either Bicep or Terraform, please review the FAQ section on ["CARML/TFVM to AVM Evolution Details"](/Azure-Verified-Modules/faq/#carmltfvm-to-avm-evolution-details)

{{< /hint >}}

## Recommended Learning

Before you start contributing to the AVM, it is **highly recommended** that you complete the following Microsoft Learn paths, modules & courses:

### Terraform

- [Hashicorp Terraform Docs](https://developer.hashicorp.com/terraform/docs)
- [Terraform associate exam prep](https://developer.hashicorp.com/terraform/tutorials/certification-003?product_intent=terraform)

### Git

- [Introduction to version control with Git](https://learn.microsoft.com/learn/paths/intro-to-vc-git/)

## Tooling

### Required Tooling

{{< hint type=tip >}}

We **strongly** recommend you use Linux or MacOS for your development environment.
You can use Windows Subsystem for Linux (WSL) if you are using Windows.

{{< /hint >}}

To contribute to this project the following tooling is required:

- [Git](https://git-scm.com/downloads)
- [Terraform](https://developer.hashicorp.com/terraform/downloads?product_intent=terraform)
- [Visual Studio Code](https://code.visualstudio.com/download)
  - [Terraform extension for Visual Studio Code](https://marketplace.visualstudio.com/items?itemName=hashicorp.terraform)
  - [EditorConfig for VS Code](https://marketplace.visualstudio.com/items?itemName=EditorConfig.EditorConfig)

### Recommended Tooling

The following tooling/extensions are recommended to assist you developing for the project:

- [CodeTour extension for Visual Studio Code](https://marketplace.visualstudio.com/items?itemName=vsls-contrib.codetour)
- [Go (for writing tests)](https://go.dev/doc/install)
- [Go extenstion for Visual Studio Code](https://marketplace.visualstudio.com/items?itemName=golang.go)
- For visibility of Bracket Pairs:
  - Inside Visual Studio Code, add `editor.bracketPairColorization.enabled`: true to your `settings.json`, to enable bracket pair colorization.

## Repositories

Each Terraform AVM module will have its own GitHub Repository in the [`Azure` GitHub Organization](https://github.com/Azure); as per [SNFR19](/Azure-Verified-Modules/specs/shared/#id-snfr19---category-publishing---registries-targeted).

This repo will be created by the Module Owners and the AVM Core team collaboratively, including the configuration of permissions as per [SNFR9](/Azure-Verified-Modules/specs/shared/#id-snfr9---category-contributionsupport---avm--pg-teams-github-repo-permissions)

## Template Repository

We have created a [template repository](https://github.com/Azure/terraform-azurerm-avm-template) to help you get started.
Please click the `use this template` and create a copy of the repo in the Azure organization.

You will then have to complete the One Engineering System (1ES) process to retain access to the repo.
See [this link (internal only)](https://dev.azure.com/CSUSolEng/Azure%20Verified%20Modules/_wiki/wikis/AVM%20Internal%20Wiki/274/1es).

## Directory and File Structure

Below is the directory and file structure expected for each AVM Terraform repository/module.
See template repo [here](https://github.com/Azure/terraform-azurerm-avm-template).

- `tests/` - (for unit tests and additional E2E/integration if required - e.g. tflint etc.)
- `modules/` - (for sub-modules only if used)
- `examples/` - (all examples must deploy without successfully without requiring input - these are customer facing)
- `/...` - (Module files that live in the root of module directory)
  - `_header.md` - (required for documentation generation)
  - `_footer.md` - (required for documentation generation)
  - `main.tf`
  - `locals.tf`
  - `variables.tf`
  - `outputs.tf`
  - `terraform.tf`
  - `locals.version.tf.json` - (required for telemetry, should match the upcoming release tag)
  - `README.md` (autogenerated)
  - `main.resource1.tf` (If a larger module you may chose to use dot notation for each resource)
  - `locals.resource1.tf`

## Casing

snake_casing is to be used as per [TFNFR3](/Azure-Verified-Modules/specs/terraform/#id-tfnfr4---category-composition---code-styling---lower-snake_casing)

## Module Publishing

When the AVM Modules are published to the Hashicorp  Registry they **MUST** follow the below requirements:

- Resource Module: `terraform-<provider>-avm-res-<rp>-<armresourcename>` as per [RMNFR1](/Azure-Verified-Modules/specs/shared/#id-rmnfr1---category-naming---module-naming)
- Pattern Module: `terraform-<provider>-avm-ptn-<patternmodulename>` as per [PMNFR1](/Azure-Verified-Modules/specs/shared/#id-pmnfr1---category-naming---module-naming)

### Publishing Process

1. Ensure your module is ready for publishing:
    1. All tests are passing
    1. All examples are passing
    1. All documentation is generated
    1. There is a release tag in the repo
1. Sign in to the [Hashicorp Registry](https://registry.terraform.io/) using GitHub
1. Publish a module by selecting the `Publish` button in the top right corner, then `Module`
1. Select the repo and accept the terms

## Telemetry

To meet [SFR3](/Azure-Verified-Modules/specs/shared/#id-sfr3---category-telemetry---deploymentusage-telemetry) & [SFR4](/Azure-Verified-Modules/specs/shared/#id-sfr4---category-telemetry---telemetry-enablement-flexibility).
We have provided the sample code below, however it is already included in the [template-repo](https://github.com/Azure/terraform-azurerm-avm-template).

{{< include file="/static/includes/sample.telem.tf" language="terraform" options="linenos=false" >}}

In addition, you should use a `locals.version.tf.json` file to store the module version in a machine readable format:

{{< hint type=important >}}

Do not include the `v` prefix in the `module_version` value.

{{< /hint >}}

```json
{
  "locals": {
    "module_version": "1.0.0"
  }
}
```
